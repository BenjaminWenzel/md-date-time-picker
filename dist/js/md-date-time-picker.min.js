"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),mdDateTimePicker=function(){function e(t){var i=arguments.length<=1||void 0===arguments[1]?"":arguments[1],a=arguments.length<=2||void 0===arguments[2]?"YYYY-MM-DD":arguments[2],o=arguments.length<=3||void 0===arguments[3]?"":arguments[3],s=arguments.length<=4||void 0===arguments[4]?"":arguments[4];_classCallCheck(this,e),this.type=t,this.init=i,this.format=a,this.display=o,this.args=s,this.type&&(this._sDialog={},this._dialog=this.constructor._dialog())}return _createClass(e,[{key:"toggle",value:function(){this._selectDialog(),this._dialog.state?this._hideDialog():("date"===this.type?this._initDateDialog(this._sDialog.date):"time"===this.type,this._showDialog())}},{key:"_selectDialog",value:function(){var e=document.getElementById("md-picker__"+[this.type]),t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),this._sDialog.picker=document.getElementById("md-picker__"+[this.type]);var i=["viewHolder","years","header","cancel","ok"],a=!0,o=!1,s=void 0;try{for(var n,r=i[Symbol.iterator]();!(a=(n=r.next()).done);a=!0){var c=n.value;this._sDialog[c]=document.getElementById("md-"+[this.type]+"__"+c)}}catch(l){o=!0,s=l}finally{try{!a&&r["return"]&&r["return"]()}finally{if(o)throw s}}this._sDialog.date||(this.init?this._sDialog.date=moment(this.init,this.format):this._sDialog.date=moment()),this._sDialog.tDate=this._sDialog.date}},{key:"_showDialog",value:function(){this._dialog.state=!0,this._sDialog.picker.classList.remove("md-picker--inactive"),this._sDialog.picker.classList.add("zoomIn")}},{key:"_hideDialog",value:function(){var e=this;this._dialog.state=!1,this._sDialog.picker.classList.add("zoomOut"),setTimeout(function(){e._sDialog.picker.classList.remove("zoomOut","zoomIn"),e._sDialog.picker.classList.add("md-picker--inactive")},300)}},{key:"_initDateDialog",value:function(e){var t=this._dialog.date.picker,i=this._dialog.date.current,a=this._dialog.date.previous,o=this._dialog.date.next;document.querySelector(t+".md-picker__subtitle").innerHTML=e.format("YYYY"),document.querySelector(t+".md-picker__title").innerHTML=e.format("ddd, MMM D"),this._initMonth(t+i,e),this._initMonth(t+a,moment(this._getPreviousMonthString(e))),this._initMonth(t+o,moment(this._getNextMonthString(e))),this._initYear(),this._attachEventHandlers(),this._switchToDateView(t,document.querySelector(t+".md-picker__subtitle"))}},{key:"_initMonth",value:function(e,t){var i=t.format("MMMM YYYY");document.querySelector(e+".md-picker__month").innerHTML=i;var a=document.querySelector(e+".md-picker__today"),o=document.querySelector(e+".md-picker__selected"),s=document.querySelectorAll(e+".md-picker__tr span"),n=parseInt(moment(t).date(1).day(),10),r=-1,c=-1,l=parseInt(moment(t).endOf("month").format("D"),10)+n-1;a&&a.classList.remove("md-picker__today"),o&&o.classList.remove("md-picker__selected"),moment().format("MMMM YYYY")===i&&(r=parseInt(moment().format("D"),10),r+=n-1),e.indexOf(this._dialog.date.current.trim())>=0&&(c=parseInt(moment(t).format("D"),10),c+=n-1);for(var d=0;d<s.length;d++){var m=s[d],_=d-n+1;n>d&&(m.classList.remove("md-picker__cell"),m.innerHTML=""),r===d&&m.classList.add("md-picker__today"),c===d&&m.classList.add("md-picker__selected"),d>=n&&l>=d&&(m.classList.add("md-picker__cell"),m.innerHTML=_,this._addCellClickEvent(m)),d>l&&(m.classList.remove("md-picker__cell"),m.innerHTML="")}}},{key:"_initYear",value:function(){for(var e=this._sDialog.years,t=parseInt(this._sDialog.date.format("YYYY"),10),i="",a=1900;2100>=a;a++)i+=a===t?'<li class="md-picker__li--current">'+a+"</li>":"<li>"+a+"</li>";e.innerHTML=i}},{key:"_switchToDateView",value:function(e,t){var i=this;t.addEventListener("click",function(){t.classList.add("md-button--unclickable");var e=i._sDialog.viewHolder,a=i._sDialog.years,o=i._sDialog.header;i._dialog.date.view?(e.classList.add("zoomOut"),a.classList.remove("md-picker__years--invisible"),a.classList.add("zoomIn")):(a.classList.add("zoomOut"),e.classList.remove("zoomOut"),e.classList.add("zoomIn"),setTimeout(function(){a.classList.remove("zoomIn","zoomOut"),a.classList.add("md-picker__years--invisible"),e.classList.remove("zoomIn")},300)),o.classList.toggle("md-picker__header--invert"),i._dialog.date.view=!i._dialog.date.view,setTimeout(function(){t.classList.remove("md-button--unclickable")},300)})}},{key:"_addCellClickEvent",value:function(e){var t=this;e.addEventListener("click",function(){var i=".md-picker-date ",a=e.innerHTML,o=document.querySelector(i+".md-picker__view--current .md-picker__month").innerHTML,s=moment(a+" "+o,"D MMMM YYYY"),n=document.querySelector(i+".md-picker__selected");n&&n.classList.remove("md-picker__selected"),e.classList.add("md-picker__selected"),t._sDialog.tDate=s,document.querySelector(i+".md-picker__subtitle").innerHTML=s.format("YYYY"),document.querySelector(i+".md-picker__title").innerHTML=s.format("ddd, MMM D")})}},{key:"_attachEventHandlers",value:function(){var e=this,t=this._sDialog.cancel,i=this._sDialog.ok;t.addEventListener("click",function(){e.toggle()}),i.addEventListener("click",function(){e._sDialog.date=e._sDialog.tDate,e.toggle()})}},{key:"_getPreviousMonthString",value:function(e){var t=void 0;return t=e.clone(),t.subtract(1,"month")}},{key:"_getNextMonthString",value:function(e){var t=void 0;return t=e.clone(),t.add(1,"month")}}],[{key:"_dialog",value:function(){return{date:{picker:".md-picker-date ",current:".md-picker__view--current ",previous:".md-picker__view--previous ",next:".md-picker__view--next ",view:!0},time:{},common:{state:!1,cancel:".md-button--cancel",ok:".md-button--ok"}}}}]),e}();