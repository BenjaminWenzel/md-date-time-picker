"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),_dialog={view:!0,state:!1},mdDateTimePicker=function(){function t(e){var i=e.type,s=e.init,a=void 0===s?moment():s,o=e.past,l=void 0===o?moment().subtract(21,"years"):o,d=e.future,r=void 0===d?a:d,n=e.mode,c=void 0===n?!1:n;_classCallCheck(this,t),this._type=i,this._init=a,this._past=l,this._future=r,this._mode=c,this._sDialog={}}return _createClass(t,[{key:"time",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return""===t?this._init:void(this._init=t)}},{key:"toggle",value:function(){this._selectDialog(),t.dialog.state?this._hideDialog():("date"===this._type?this._initDateDialog(this._init):"time"===this._type&&this._initTimeDialog(this._init),this._showDialog())}},{key:"_selectDialog",value:function(){var t=document.getElementById("mddtp-picker__"+[this._type]),e=t.cloneNode(!0);t.parentNode.replaceChild(e,t),this._sDialog.picker=document.getElementById("mddtp-picker__"+[this._type]);for(var i=["viewHolder","years","header","cancel","ok","left","right","previous","current","next","subtitle","title","titleDay","titleMonth","AM","PM","needle","hourView","minuteView","hour","minute"],s=i.length;s--;)this._sDialog[i[s]]=document.getElementById("mddtp-"+this._type+"__"+i[s]);this._sDialog.tDate=this._init.clone(),this._sDialog.sDate=this._init.clone()}},{key:"_showDialog",value:function(){var e=this;t.dialog.state=!0,this._sDialog.picker.classList.remove("mddtp-picker--inactive"),this._sDialog.picker.classList.add("zoomIn"),setTimeout(function(){e._sDialog.picker.classList.remove("zoomIn")},300)}},{key:"_hideDialog",value:function(){var e=this,i=this._sDialog.years,s=e._sDialog.title,a=e._sDialog.subtitle,o=this._sDialog.viewHolder,l=this._sDialog.AM,d=this._sDialog.PM,r=this._sDialog.minute,n=this._sDialog.hour;t.dialog.state=!1,t.dialog.view=!0,this._sDialog.picker.classList.add("zoomOut"),"date"===this._type?(i.classList.remove("zoomIn","zoomOut"),i.classList.add("mddtp-picker__years--invisible"),s.classList.remove("mddtp-picker__color--active"),a.classList.add("mddtp-picker__color--active"),o.classList.remove("zoomOut")):(l.classList.remove("mddtp-picker__color--active"),d.classList.remove("mddtp-picker__color--active"),r.classList.remove("mddtp-picker__color--active"),n.classList.add("mddtp-picker__color--active"),a.setAttribute("style","display: none")),setTimeout(function(){e._sDialog.picker.classList.remove("zoomOut"),e._sDialog.picker.classList.add("mddtp-picker--inactive")},300)}},{key:"_initTimeDialog",value:function(t){var e=this._sDialog.hour,i=this._sDialog.minute,s=this._sDialog.subtitle;this._mode?e.innerHTML=t.format("H"):(e.innerHTML=t.format("h"),this._sDialog[t.format("A")].classList.add("mddtp-picker__color--active"),s.removeAttribute("style")),i.innerHTML=t.format("mm"),this._initHour(),this._initMinute(),this._attachEventHandlers(),this._changeM(),this._switchToView(e),this._switchToView(i)}},{key:"_initHour",value:function(){var t=this._sDialog.hourView,e=this._sDialog.needle,i=document.createDocumentFragment();if(this._mode){parseInt(this._sDialog.tDate.format("H"),10)}else for(var s=parseInt(this._sDialog.tDate.format("h"),10),a=3,o=0;14>=a;a++,o+=5){var l=void 0,d=document.createElement("div"),r=document.createElement("span");d.classList.add("mddtp-picker__cell"),l=a,a>12?r.textContent=l-12:r.textContent=l,o&&d.classList.add("mddtp-picker__cell--rotate-"+o),s===l&&(d.classList.add("mddtp-picker__cell--selected"),e.classList.add("mddtp-picker__cell--rotate-"+o)),d.appendChild(r),i.appendChild(d)}for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(i)}},{key:"_initMinute",value:function(){for(var t=this._sDialog.minuteView,e=parseInt(this._sDialog.tDate.format("mm"),10),i=document.createDocumentFragment(),s=15,a=0;70>=s;s+=5,a+=5){var o=void 0,l=document.createElement("div"),d=document.createElement("span");l.classList.add("mddtp-picker__cell"),o=s,s>55?d.textContent=this._numWithZero(o-60):d.textContent=o,a&&l.classList.add("mddtp-picker__cell--rotate-"+a),e!=o&&e-1!=o&&e+1!=o||l.classList.add("mddtp-picker__cell--selected"),l.appendChild(d),i.appendChild(l)}for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(i)}},{key:"_initDateDialog",value:function(t){var e=this._sDialog.subtitle,i=this._sDialog.title,s=this._sDialog.titleDay,a=this._sDialog.titleMonth;e.innerHTML=t.format("YYYY"),s.innerHTML=t.format("ddd, "),a.innerHTML=t.format("MMM D"),this._initYear(),this._initViewHolder(),this._attachEventHandlers(),this._changeMonth(),this._switchToView(e),this._switchToView(i)}},{key:"_initViewHolder",value:function(){var t=this._sDialog.tDate,e=(this._sDialog.picker,this._sDialog.current),i=this._sDialog.previous,s=this._sDialog.next,a=this._past,o=this._future;t.isBefore(a,"month")&&(t=a.clone()),t.isAfter(o,"month")&&(t=o.clone()),this._sDialog.tDate=t,this._initMonth(e,t),this._initMonth(s,moment(this._getMonth(t,1))),this._initMonth(i,moment(this._getMonth(t,-1))),this._switchToView(e.querySelector(".mddtp-picker__month")),this._toMoveMonth()}},{key:"_initMonth",value:function(t,e){var i=e.format("MMMM YYYY");t.querySelector(".mddtp-picker__month").innerHTML=i;var s=document.createDocumentFragment(),a=t.querySelector(".mddtp-picker__tr"),o=parseInt(moment(e).date(1).day(),10),l=-1,d=-1,r=parseInt(moment(e).endOf("month").format("D"),10)+o-1,n=o,c=r;moment().isSame(e,"month")&&(l=parseInt(moment().format("D"),10),l+=o-1),this._past.isSame(e,"month")&&(n=parseInt(this._past.format("D"),10),n+=o-1),this._future.isSame(e,"month")&&(c=parseInt(this._future.format("D"),10),c+=o-1),this._sDialog.sDate.isSame(e,"month")&&(d=parseInt(moment(e).format("D"),10),d+=o-1);for(var _=0;42>_;_++){var h=document.createElement("span"),m=_-o+1;_>=o&&r>=_&&(_>c||n>_?h.classList.add("mddtp-picker__cell--disabled"):h.classList.add("mddtp-picker__cell"),h.innerHTML=m),l===_&&h.classList.add("mddtp-picker__cell--today"),d===_&&h.classList.add("mddtp-picker__cell--selected"),s.appendChild(h)}for(;a.lastChild;)a.removeChild(a.lastChild);a.appendChild(s),this._addCellClickEvent(a)}},{key:"_initYear",value:function(){for(var t=this._sDialog.years,e=this._sDialog.tDate.year(),i=document.createDocumentFragment(),s=this._past.year(),a=this._future.year(),o=s;a>=o;o++){var l=document.createElement("li");l.textContent=o,o===e&&(l.id="mddtp-date__currentYear",l.classList.add("mddtp-picker__li--current")),i.appendChild(l)}for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(i),this._changeYear(t)}},{key:"_switchToView",value:function(t){var e=this;"date"==this._type?t.addEventListener("click",function(){e._switchToDateView(t,e)},!1):t.addEventListener("click",function(){e._switchToTimeView(t,e)},!1)}},{key:"_switchToTimeView",value:function(e,i){var s=this._sDialog.hourView,a=this._sDialog.minuteView,o=this._sDialog.hour,l=this._sDialog.minute,d="mddtp-picker__color--active",r=this._sDialog.needle,n=60,c=void 0;s.classList.toggle("mddtp-picker__circularView--hidden"),a.classList.toggle("mddtp-picker__circularView--hidden"),o.classList.toggle(d),l.classList.toggle(d),r.className="",r.classList.add("mddtp-picker__selection"),t.dialog.view?c=this._sDialog.tDate.format("m"):this._mode?(n=24,c=this._sDialog.tDate.format("H")):(n=12,c=this._sDialog.tDate.format("h"));var _=this._calcRotation(n,parseInt(c,10));_&&r.classList.add(_),t.dialog.view=!t.dialog.view}},{key:"_switchToDateView",value:function(e,i){e.setAttribute("disabled","");var s=i._sDialog.viewHolder,a=i._sDialog.years,o=i._sDialog.title,l=i._sDialog.subtitle,d=document.getElementById("mddtp-date__currentYear");t.dialog.view?(s.classList.add("zoomOut"),a.classList.remove("mddtp-picker__years--invisible"),a.classList.add("zoomIn"),d.scrollIntoViewIfNeeded()):(a.classList.add("zoomOut"),s.classList.remove("zoomOut"),s.classList.add("zoomIn"),setTimeout(function(){a.classList.remove("zoomIn","zoomOut"),a.classList.add("mddtp-picker__years--invisible"),s.classList.remove("zoomIn")},300)),o.classList.toggle("mddtp-picker__color--active"),l.classList.toggle("mddtp-picker__color--active"),t.dialog.view=!t.dialog.view,setTimeout(function(){e.removeAttribute("disabled")},300)}},{key:"_addCellClickEvent",value:function(t){var e=this;t.addEventListener("click",function(t){if(t.target&&"SPAN"==t.target.nodeName&&t.target.classList.contains("mddtp-picker__cell")){var i=e._sDialog.picker,s=t.target.innerHTML,a=e._sDialog.tDate.date(s),o=i.querySelector(".mddtp-picker__cell--selected"),l=e._sDialog.subtitle,d=e._sDialog.titleDay,r=e._sDialog.titleMonth;o&&o.classList.remove("mddtp-picker__cell--selected"),t.target.classList.add("mddtp-picker__cell--selected"),e._sDialog.sDate=a.clone(),l.innerHTML=a.year(),d.innerHTML=a.format("ddd, "),r.innerHTML=a.format("MMM D")}},!1)}},{key:"_toMoveMonth",value:function(){var t=this._sDialog.tDate,e=this._sDialog.left,i=this._sDialog.right,s=this._past,a=this._future;e.removeAttribute("disabled"),i.removeAttribute("disabled"),e.classList.remove("mddtp-button--disabled"),i.classList.remove("mddtp-button--disabled"),t.isSame(s,"month")&&(e.setAttribute("disabled",""),e.classList.add("mddtp-button--disabled")),t.isSame(a,"month")&&(i.setAttribute("disabled",""),i.classList.add("mddtp-button--disabled"))}},{key:"_changeMonth",value:function(){function t(t,a){var o=!1,d=e._sDialog.next,r=e._sDialog.current,n=e._sDialog.previous;i.setAttribute("disabled",""),s.setAttribute("disabled",""),r.classList.add(t),n.classList.add(t),d.classList.add(t);var c=a.cloneNode(!0),_=void 0;a===d?(_=n,r.parentNode.appendChild(c),d.id=r.id,r.id=n.id,n=r,r=d,d=c):(o=!0,_=d,n.id=r.id,r.id=d.id,d=r,r=n),setTimeout(function(){a===n&&(r.parentNode.insertBefore(c,r),n=c),e._sDialog.next=d,e._sDialog.current=r,e._sDialog.previous=n,r.classList.add(l),d.classList.add(l),n.classList.add(l),r.classList.remove(t),d.classList.remove(t),n.classList.remove(t),_.parentNode.removeChild(_)},300),setTimeout(function(){r.classList.remove(l),d.classList.remove(l),n.classList.remove(l),o?e._sDialog.tDate=e._getMonth(e._sDialog.tDate,-1):e._sDialog.tDate=e._getMonth(e._sDialog.tDate,1),e._initViewHolder()},350),setTimeout(function(){i.classList.contains("mddtp-button--disabled")||i.removeAttribute("disabled"),s.classList.contains("mddtp-button--disabled")||s.removeAttribute("disabled")},400)}var e=this,i=this._sDialog.left,s=this._sDialog.right,a="mddtp-picker__view--left",o="mddtp-picker__view--right",l="mddtp-picker__view--pause";i.addEventListener("click",function(){t(o,e._sDialog.previous)},!1),s.addEventListener("click",function(){t(a,e._sDialog.next)},!1)}},{key:"_changeYear",value:function(t){var e=this;t.addEventListener("click",function(i){if(i.target&&"LI"==i.target.nodeName){var s=document.getElementById("mddtp-date__currentYear");s.id="",s.classList.remove("mddtp-picker__li--current"),i.target.id="mddtp-date__currentYear",i.target.classList.add("mddtp-picker__li--current"),e._switchToDateView(t,e),e._sDialog.tDate.year(parseInt(i.target.innerHTML,10)),e._initViewHolder()}},!1)}},{key:"_changeM",value:function(){var t=this,e=this._sDialog.AM,i=this._sDialog.PM;e.addEventListener("click",function(s){var a=t._sDialog.sDate.format("A");"PM"===a&&(t._sDialog.sDate.subtract(12,"h"),e.classList.toggle("mddtp-picker__color--active"),i.classList.toggle("mddtp-picker__color--active"))},!1),i.addEventListener("click",function(s){var a=t._sDialog.sDate.format("A");"AM"===a&&(t._sDialog.sDate.add(12,"h"),e.classList.toggle("mddtp-picker__color--active"),i.classList.toggle("mddtp-picker__color--active"))},!1)}},{key:"_attachEventHandlers",value:function(){var t=this,e=this._sDialog.ok,i=this._sDialog.cancel;i.addEventListener("click",function(){t.toggle()},!1),e.addEventListener("click",function(){t._init=t._sDialog.sDate,t.toggle()},!1)}},{key:"_getMonth",value:function(t,e){var i=void 0;return i=t.clone(),e>0?i.add(Math.abs(e),"M"):i.subtract(Math.abs(e),"M")}},{key:"_numWithZero",value:function(t){return t>9?""+t:"0"+t}},{key:"_calcRotation",value:function(t,e){var i=t/12*3,s=void 0,a=void 0;return 12===t?(3>e&&e>=1&&(e+=12),s=5):24===t?s=10:(15>e&&e>=0&&(e+=60),s=1),e-=i,e&&(a="mddtp-picker__cell--rotate-"+e*s),a}}],[{key:"dialog",get:function(){return _dialog}}]),t}();Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(t){t=0===arguments.length?!0:!!t;var e=this.parentNode,i=window.getComputedStyle(e,null),s=parseInt(i.getPropertyValue("border-top-width"),10),a=parseInt(i.getPropertyValue("border-left-width"),10),o=this.offsetTop-e.offsetTop<e.scrollTop,l=this.offsetTop-e.offsetTop+this.clientHeight-s>e.scrollTop+e.clientHeight,d=this.offsetLeft-e.offsetLeft<e.scrollLeft,r=this.offsetLeft-e.offsetLeft+this.clientWidth-a>e.scrollLeft+e.clientWidth,n=o&&!l;(o||l)&&t&&(e.scrollTop=this.offsetTop-e.offsetTop-e.clientHeight/2-s+this.clientHeight/2),(d||r)&&t&&(e.scrollLeft=this.offsetLeft-e.offsetLeft-e.clientWidth/2-a+this.clientWidth/2),(o||l||d||r)&&!t&&this.scrollIntoView(n)});